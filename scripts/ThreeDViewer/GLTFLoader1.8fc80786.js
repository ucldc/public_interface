parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"v7ds":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GLTFLoader=void 0;var e=t(require("three-v86"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function t(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=n?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(a,i,s):a[i]=e[i]}return a.default=e,t&&t.set(e,a),a}e.GLTFLoader=function(){function r(r){this.manager=void 0!==r?r:e.DefaultLoadingManager}function t(){var e={};return{get:function(r){return e[r]},add:function(r,t){e[r]=t},remove:function(r){delete e[r]},removeAll:function(){e={}},update:function(r,t){for(var a in e){var n=e[a];n.update&&n.update(r,t)}}}}function a(r,t){var a={},n=r.material.uniforms;for(var i in n){var s=n[i];if(s.semantic){var o=s.node,c=r;o&&(c=t[o]),a[i]={semantic:s.semantic,sourceNode:c,targetNode:r,uniform:s}}}this.boundUniforms=a,this._m4=new e.Matrix4}r.prototype={constructor:r,load:function(r,t,a,n){var i=this,s=this.path&&"string"==typeof this.path?this.path:e.Loader.prototype.extractUrlBase(r),o=new e.FileLoader(i.manager);o.setResponseType("arraybuffer"),o.load(r,function(e){i.parse(e,t,s)},a,n)},setCrossOrigin:function(e){this.crossOrigin=e},setPath:function(e){this.path=e},parse:function(e,r,t){var a,o={};S(new Uint8Array(e,0,4))===s.magic?(o[n.KHR_BINARY_GLTF]=new c(e),a=o[n.KHR_BINARY_GLTF].content):a=S(new Uint8Array(e));var u=JSON.parse(a);u.extensionsUsed&&u.extensionsUsed.indexOf(n.KHR_MATERIALS_COMMON)>=0&&(o[n.KHR_MATERIALS_COMMON]=new i(u)),console.time("GLTFLoader"),new E(u,o,{path:t||this.path,crossOrigin:this.crossOrigin}).parse(function(e,t,a,n){console.timeEnd("GLTFLoader"),r({scene:e,scenes:t,cameras:a,animations:n})})}},r.Shaders={update:function(){console.warn("THREE.GLTFLoader.Shaders has been deprecated, and now updates automatically.")}},a.prototype.update=function(e,r){var t=this.boundUniforms;for(var a in t){var n=t[a];switch(n.semantic){case"MODELVIEW":n.uniform.value.multiplyMatrices(r.matrixWorldInverse,n.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var i=n.uniform.value;this._m4.multiplyMatrices(r.matrixWorldInverse,n.sourceNode.matrixWorld),i.getNormalMatrix(this._m4);break;case"PROJECTION":n.uniform.value.copy(r.projectionMatrix);break;case"JOINTMATRIX":for(var s=n.uniform.value,o=0;o<s.length;o++)s[o].getInverse(n.sourceNode.matrixWorld).multiply(n.targetNode.skeleton.bones[o].matrixWorld).multiply(n.targetNode.skeleton.boneInverses[o]).multiply(n.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+n.semantic)}}},r.Animations={update:function(){console.warn("THREE.GLTFLoader.Animation has been deprecated. Use THREE.AnimationMixer instead.")}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_MATERIALS_COMMON:"KHR_materials_common"};function i(r){this.name=n.KHR_MATERIALS_COMMON,this.lights={};var t=(r.extensions&&r.extensions[n.KHR_MATERIALS_COMMON]||{}).lights||{};for(var a in t){var i,s=t[a],o=s[s.type],c=(new e.Color).fromArray(o.color);switch(s.type){case"directional":(i=new e.DirectionalLight(c)).position.set(0,0,1);break;case"point":i=new e.PointLight(c);break;case"spot":(i=new e.SpotLight(c)).position.set(0,0,1);break;case"ambient":i=new e.AmbientLight(c)}i&&(this.lights[a]=i)}}var s={magic:"glTF",version:1,contentFormat:0},o=20;function c(e){this.name=n.KHR_BINARY_GLTF;var r=new DataView(e,0,o),t={magic:S(new Uint8Array(e.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0),contentLength:r.getUint32(12,!0),contentFormat:r.getUint32(16,!0)};for(var a in s){var i=s[a];if(t[a]!==i)throw new Error('Unsupported glTF-Binary header: Expected "%s" to be "%s".',a,i)}var c=new Uint8Array(e,o,t.contentLength);this.header=t,this.content=S(c),this.body=e.slice(o+t.contentLength,t.length)}c.prototype.loadShader=function(e,r){var t=r[e.extensions[n.KHR_BINARY_GLTF].bufferView];return S(new Uint8Array(t))},c.prototype.loadTextureSourceUri=function(e,r){var t=e.extensions[n.KHR_BINARY_GLTF],a=r[t.bufferView],i=S(new Uint8Array(a));return"data:"+t.mimeType+";base64,"+btoa(i)};var u={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},d={5126:Number,35675:e.Matrix3,35676:e.Matrix4,35664:e.Vector2,35665:e.Vector3,35666:e.Vector4,35678:e.Texture},p={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},l={9728:e.NearestFilter,9729:e.LinearFilter,9984:e.NearestMipMapNearestFilter,9985:e.LinearMipMapNearestFilter,9986:e.NearestMipMapLinearFilter,9987:e.LinearMipMapLinearFilter},f={33071:e.ClampToEdgeWrapping,33648:e.MirroredRepeatWrapping,10497:e.RepeatWrapping},h={6406:e.AlphaFormat,6407:e.RGBFormat,6408:e.RGBAFormat,6409:e.LuminanceFormat,6410:e.LuminanceAlphaFormat},m={5121:e.UnsignedByteType,32819:e.UnsignedShort4444Type,32820:e.UnsignedShort5551Type,33635:e.UnsignedShort565Type},v={1028:e.BackSide,1029:e.FrontSide},A={512:e.NeverDepth,513:e.LessDepth,514:e.EqualDepth,515:e.LessEqualDepth,516:e.GreaterEqualDepth,517:e.NotEqualDepth,518:e.GreaterEqualDepth,519:e.AlwaysDepth},y={32774:e.AddEquation,32778:e.SubtractEquation,32779:e.ReverseSubtractEquation},b={0:e.ZeroFactor,1:e.OneFactor,768:e.SrcColorFactor,769:e.OneMinusSrcColorFactor,770:e.SrcAlphaFactor,771:e.OneMinusSrcAlphaFactor,772:e.DstAlphaFactor,773:e.OneMinusDstAlphaFactor,774:e.DstColorFactor,775:e.OneMinusDstColorFactor,776:e.SrcAlphaSaturateFactor},w={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},L={scale:"scale",translation:"position",rotation:"quaternion"},O={LINEAR:e.InterpolateLinear,STEP:e.InterpolateDiscrete},T={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};function M(e,r,t){if(!e)return Promise.resolve();var a,n=[];if("[object Array]"===Object.prototype.toString.call(e)){a=[];for(var i=e.length,s=0;s<i;s++){(c=r.call(t||this,e[s],s))&&(n.push(c),c instanceof Promise?c.then(function(e,r){a[e]=r}.bind(this,s)):a[s]=c)}}else for(var o in a={},e){var c;if(e.hasOwnProperty(o))(c=r.call(t||this,e[o],o))&&(n.push(c),c instanceof Promise?c.then(function(e,r){a[e]=r}.bind(this,o)):a[o]=c)}return Promise.all(n).then(function(){return a})}function g(e,r){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:(r||"")+e}function S(e){window.TextDecoder;for(var r="",t=0,a=e.length;t<a;t++)r+=String.fromCharCode(e[t]);return r}function R(e){this.isDeferredShaderMaterial=!0,this.params=e}function E(e,r,a){this.json=e||{},this.extensions=r||{},this.options=a||{},this.cache=new t}return R.prototype.create=function(){var r=e.UniformsUtils.clone(this.params.uniforms);for(var t in this.params.uniforms){var a=this.params.uniforms[t];a.value instanceof e.Texture&&(r[t].value=a.value,r[t].value.needsUpdate=!0),r[t].semantic=a.semantic,r[t].node=a.node}return this.params.uniforms=r,new e.RawShaderMaterial(this.params)},E.prototype._withDependencies=function(e){for(var r={},t=0;t<e.length;t++){var a=e[t],n="load"+a.charAt(0).toUpperCase()+a.slice(1),i=this.cache.get(a);if(void 0!==i)r[a]=i;else if(this[n]){var s=this[n]();this.cache.add(a,s),r[a]=s}}return M(r,function(e){return e})},E.prototype.parse=function(e){var r=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(t){var a=[];for(var n in t.scenes)a.push(t.scenes[n]);var i=void 0!==r.scene?t.scenes[r.scene]:a[0],s=[];for(var n in t.cameras){var o=t.cameras[n];s.push(o)}var c=[];for(var n in t.animations)c.push(t.animations[n]);e(i,a,s,c)})},E.prototype.loadShaders=function(){var r=this.json,t=this.extensions,a=this.options;return this._withDependencies(["bufferViews"]).then(function(i){return M(r.shaders,function(r){return r.extensions&&r.extensions[n.KHR_BINARY_GLTF]?t[n.KHR_BINARY_GLTF].loadShader(r,i.bufferViews):new Promise(function(t){var n=new e.FileLoader;n.setResponseType("text"),n.load(g(r.uri,a.path),function(e){t(e)})})})})},E.prototype.loadBuffers=function(){var r=this.json,t=this.extensions,a=this.options;return M(r.buffers,function(r,i){return"binary_glTF"===i?t[n.KHR_BINARY_GLTF].body:"arraybuffer"===r.type||void 0===r.type?new Promise(function(t){var n=new e.FileLoader;n.setResponseType("arraybuffer"),n.load(g(r.uri,a.path),function(e){t(e)})}):void console.warn("THREE.GLTFLoader: "+r.type+" buffer type is not supported")})},E.prototype.loadBufferViews=function(){var e=this.json;return this._withDependencies(["buffers"]).then(function(r){return M(e.bufferViews,function(e){var t=r.buffers[e.buffer],a=void 0!==e.byteLength?e.byteLength:0;return t.slice(e.byteOffset,e.byteOffset+a)})})},E.prototype.loadAccessors=function(){var r=this.json;return this._withDependencies(["bufferViews"]).then(function(t){return M(r.accessors,function(r){var a=t.bufferViews[r.bufferView],n=w[r.type],i=p[r.componentType],s=i.BYTES_PER_ELEMENT,o=s*n;if(r.byteStride&&r.byteStride!==o){var c=new i(a),u=new e.InterleavedBuffer(c,r.byteStride/s);return new e.InterleavedBufferAttribute(u,n,r.byteOffset/s)}return c=new i(a,r.byteOffset,r.count*n),new e.BufferAttribute(c,n)})})},E.prototype.loadTextures=function(){var r=this.json,t=this.extensions,a=this.options;return this._withDependencies(["bufferViews"]).then(function(i){return M(r.textures,function(s){if(s.source)return new Promise(function(o){var c=r.images[s.source],u=c.uri;c.extensions&&c.extensions[n.KHR_BINARY_GLTF]&&(u=t[n.KHR_BINARY_GLTF].loadTextureSourceUri(c,i.bufferViews));var d=e.Loader.Handlers.get(u);null===d&&(d=new e.TextureLoader),d.setCrossOrigin(a.crossOrigin),d.load(g(u,a.path),function(t){if(t.flipY=!1,void 0!==s.name&&(t.name=s.name),t.format=void 0!==s.format?h[s.format]:e.RGBAFormat,void 0!==s.internalFormat&&t.format!==h[s.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==s.type?m[s.type]:e.UnsignedByteType,s.sampler){var a=r.samplers[s.sampler];t.magFilter=l[a.magFilter]||e.LinearFilter,t.minFilter=l[a.minFilter]||e.NearestMipMapLinearFilter,t.wrapS=f[a.wrapS]||e.RepeatWrapping,t.wrapT=f[a.wrapT]||e.RepeatWrapping}o(t)},void 0,function(){o()})})})})},E.prototype.loadMaterials=function(){var r=this.json;return this._withDependencies(["shaders","textures"]).then(function(t){return M(r.materials,function(a){var i,s,o={},c={};if(a.extensions&&a.extensions[n.KHR_MATERIALS_COMMON]&&(s=a.extensions[n.KHR_MATERIALS_COMMON]),s){var p=["ambient","emission","transparent","transparency","doubleSided"];switch(s.technique){case"BLINN":case"PHONG":i=e.MeshPhongMaterial,p.push("diffuse","specular","shininess");break;case"LAMBERT":i=e.MeshLambertMaterial,p.push("diffuse");break;case"CONSTANT":default:i=e.MeshBasicMaterial}p.forEach(function(e){void 0!==s.values[e]&&(o[e]=s.values[e])}),(s.doubleSided||o.doubleSided)&&(c.side=e.DoubleSide),(s.transparent||o.transparent)&&(c.transparent=!0,c.opacity=void 0!==o.transparency?o.transparency:1)}else if(void 0===a.technique)i=e.MeshPhongMaterial,Object.assign(o,a.values);else{i=R;var l=r.techniques[a.technique];c.uniforms={};var f=r.programs[l.program];if(f){c.fragmentShader=t.shaders[f.fragmentShader],c.fragmentShader||(console.warn("ERROR: Missing fragment shader definition:",f.fragmentShader),i=e.MeshPhongMaterial);var h=t.shaders[f.vertexShader];h||(console.warn("ERROR: Missing vertex shader definition:",f.vertexShader),i=e.MeshPhongMaterial),c.vertexShader=function(e,r){var t={};for(var a in r.attributes){var n=r.attributes[a],i=(p=r.parameters[n]).type,s=p.semantic;t[a]={type:i,semantic:s}}var o=r.parameters,c=r.attributes,u={};for(var a in t){var d=o[n=c[a]];(s=d.semantic)&&(u[a]=d)}for(var n in u){s=(p=u[n]).semantic;var p,l=new RegExp("\\b"+n+"\\b","g");switch(s){case"POSITION":e=e.replace(l,"position");break;case"NORMAL":e=e.replace(l,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":e=e.replace(l,"uv");break;case"TEXCOORD_1":e=e.replace(l,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":e=e.replace(l,"color");break;case"WEIGHT":e=e.replace(l,"skinWeight");break;case"JOINT":e=e.replace(l,"skinIndex")}}return e}(h,l);var m=l.uniforms;for(var w in m){var L=m[w],O=l.parameters[L],M=O.type;if(!d[M])throw new Error("Unknown shader uniform param type: "+M);var g,S=O.count;void 0!==a.values&&(g=a.values[L]);var E=new d[M],_=O.semantic,F=O.node;switch(M){case u.FLOAT:E=O.value,"transparency"==L&&(c.transparent=!0),void 0!==g&&(E=g);break;case u.FLOAT_VEC2:case u.FLOAT_VEC3:case u.FLOAT_VEC4:case u.FLOAT_MAT3:O&&O.value&&E.fromArray(O.value),g&&E.fromArray(g);break;case u.FLOAT_MAT2:console.warn("FLOAT_MAT2 is not a supported uniform type");break;case u.FLOAT_MAT4:if(S){E=new Array(S);for(var x=0;x<S;x++)E[x]=new d[M];if(O&&O.value){var N=O.value;E.fromArray(N)}g&&E.fromArray(g)}else{if(O&&O.value){var D=O.value;E.fromArray(D)}g&&E.fromArray(g)}break;case u.SAMPLER_2D:E=void 0!==g?t.textures[g]:void 0!==O.value?t.textures[O.value]:null}c.uniforms[w]={value:E,semantic:_,node:F}}for(var C=l.states||{},I=C.enable||[],k=C.functions||{},B=!1,G=!1,H=!1,P=0,U=I.length;P<U;P++){var j=I[P];switch(T[j]){case"CULL_FACE":B=!0;break;case"DEPTH_TEST":G=!0;break;case"BLEND":H=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+j)}}c.side=B?void 0!==k.cullFace?v[k.cullFace]:e.FrontSide:e.DoubleSide,c.depthTest=G,c.depthFunc=void 0!==k.depthFunc?A[k.depthFunc]:e.LessDepth,c.depthWrite=void 0===k.depthMask||k.depthMask[0],c.blending=H?e.CustomBlending:e.NoBlending,c.transparent=H;var V=k.blendEquationSeparate;void 0!==V?(c.blendEquation=y[V[0]],c.blendEquationAlpha=y[V[1]]):(c.blendEquation=e.AddEquation,c.blendEquationAlpha=e.AddEquation);var K=k.blendFuncSeparate;void 0!==K?(c.blendSrc=b[K[0]],c.blendDst=b[K[1]],c.blendSrcAlpha=b[K[2]],c.blendDstAlpha=b[K[3]]):(c.blendSrc=e.OneFactor,c.blendDst=e.ZeroFactor,c.blendSrcAlpha=e.OneFactor,c.blendDstAlpha=e.ZeroFactor)}}Array.isArray(o.diffuse)?c.color=(new e.Color).fromArray(o.diffuse):"string"==typeof o.diffuse&&(c.map=t.textures[o.diffuse]),delete c.diffuse,"string"==typeof o.reflective&&(c.envMap=t.textures[o.reflective]),"string"==typeof o.bump&&(c.bumpMap=t.textures[o.bump]),Array.isArray(o.emission)?i===e.MeshBasicMaterial?c.color=(new e.Color).fromArray(o.emission):c.emissive=(new e.Color).fromArray(o.emission):"string"==typeof o.emission&&(i===e.MeshBasicMaterial?c.map=t.textures[o.emission]:c.emissiveMap=t.textures[o.emission]),Array.isArray(o.specular)?c.specular=(new e.Color).fromArray(o.specular):"string"==typeof o.specular&&(c.specularMap=t.textures[o.specular]),void 0!==o.shininess&&(c.shininess=o.shininess);var q=new i(c);return void 0!==a.name&&(q.name=a.name),q})})},E.prototype.loadMeshes=function(){var r=this.json;return this._withDependencies(["accessors","materials"]).then(function(t){return M(r.meshes,function(r){var a=new e.Group;void 0!==r.name&&(a.name=r.name),r.extras&&(a.userData=r.extras);var n=r.primitives||[];for(var i in n){var s=n[i];if(s.mode===u.TRIANGLES||void 0===s.mode){var o=new e.BufferGeometry,c=s.attributes;for(var d in c){if(!(f=c[d]))return;var p=t.accessors[f];switch(d){case"POSITION":o.addAttribute("position",p);break;case"NORMAL":o.addAttribute("normal",p);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":o.addAttribute("uv",p);break;case"TEXCOORD_1":o.addAttribute("uv2",p);break;case"COLOR_0":case"COLOR0":case"COLOR":o.addAttribute("color",p);break;case"WEIGHT":o.addAttribute("skinWeight",p);break;case"JOINT":o.addAttribute("skinIndex",p)}}s.indices&&o.setIndex(t.accessors[s.indices]);var l=void 0!==t.materials?t.materials[s.material]:new e.MeshPhongMaterial({color:0,emissive:8947848,specular:0,shininess:0,transparent:!1,depthTest:!0,side:e.FrontSide});(h=new e.Mesh(o,l)).castShadow=!0,h.name="0"===i?a.name:a.name+i,s.extras&&(h.userData=s.extras),a.add(h)}else if(s.mode===u.LINES){o=new e.BufferGeometry,c=s.attributes;for(var d in c){var f;if(!(f=c[d]))return;p=t.accessors[f];switch(d){case"POSITION":o.addAttribute("position",p);break;case"COLOR_0":case"COLOR0":case"COLOR":o.addAttribute("color",p)}}var h;l=t.materials[s.material];s.indices?(o.setIndex(t.accessors[s.indices]),h=new e.LineSegments(o,l)):h=new e.Line(o,l),h.name="0"===i?a.name:a.name+i,s.extras&&(h.userData=s.extras),a.add(h)}else console.warn("Only triangular and line primitives are supported")}return a})})},E.prototype.loadCameras=function(){return M(this.json.cameras,function(r){if("perspective"==r.type&&r.perspective){var t=r.perspective.yfov,a=void 0!==r.perspective.aspectRatio?r.perspective.aspectRatio:1,n=t*a,i=new e.PerspectiveCamera(e.Math.radToDeg(n),a,r.perspective.znear||1,r.perspective.zfar||2e6);return void 0!==r.name&&(i.name=r.name),r.extras&&(i.userData=r.extras),i}if("orthographic"==r.type&&r.orthographic){i=new e.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,r.orthographic.znear,r.orthographic.zfar);return void 0!==r.name&&(i.name=r.name),r.extras&&(i.userData=r.extras),i}})},E.prototype.loadSkins=function(){var r=this.json;return this._withDependencies(["accessors"]).then(function(t){return M(r.skins,function(r){var a=new e.Matrix4;return void 0!==r.bindShapeMatrix&&a.fromArray(r.bindShapeMatrix),{bindShapeMatrix:a,jointNames:r.jointNames,inverseBindMatrices:t.accessors[r.inverseBindMatrices]}})})},E.prototype.loadAnimations=function(){var r=this.json;return this._withDependencies(["accessors","nodes"]).then(function(t){return M(r.animations,function(r,a){var n=[];for(var i in r.channels){var s=r.channels[i],o=r.samplers[s.sampler];if(o){var c=s.target,u=c.id,d=void 0!==r.parameters?r.parameters[o.input]:o.input,p=void 0!==r.parameters?r.parameters[o.output]:o.output,l=t.accessors[d],f=t.accessors[p],h=t.nodes[u];if(h){h.updateMatrix(),h.matrixAutoUpdate=!0;var m=L[c.path]===L.rotation?e.QuaternionKeyframeTrack:e.VectorKeyframeTrack,v=h.name?h.name:h.uuid,A=void 0!==o.interpolation?O[o.interpolation]:e.InterpolateLinear;n.push(new m(v+"."+L[c.path],e.AnimationUtils.arraySlice(l.array,0),e.AnimationUtils.arraySlice(f.array,0),A))}}}u=void 0!==r.name?r.name:"animation_"+a;return new e.AnimationClip(u,void 0,n)})})},E.prototype.loadNodes=function(){var r=this.json,t=this.extensions,a=this;return M(r.nodes,function(r){var t,a=new e.Matrix4;return r.jointName?((t=new e.Bone).name=void 0!==r.name?r.name:r.jointName,t.jointName=r.jointName):(t=new e.Object3D,void 0!==r.name&&(t.name=r.name)),r.extras&&(t.userData=r.extras),void 0!==r.matrix?(a.fromArray(r.matrix),t.applyMatrix(a)):(void 0!==r.translation&&t.position.fromArray(r.translation),void 0!==r.rotation&&t.quaternion.fromArray(r.rotation),void 0!==r.scale&&t.scale.fromArray(r.scale)),t}).then(function(i){return a._withDependencies(["meshes","skins","cameras"]).then(function(a){return M(i,function(s,o){var c=r.nodes[o];if(void 0!==c.meshes)for(var u in c.meshes){var d=c.meshes[u],p=a.meshes[d];if(void 0!==p)for(var l in p.children){var f,h=p.children[l],m=h.material,v=h.geometry,A=h.userData,y=h.name;switch(m.isDeferredShaderMaterial?m=b=m.create():b=m,h.type){case"LineSegments":h=new e.LineSegments(v,b);break;case"LineLoop":h=new e.LineLoop(v,b);break;case"Line":h=new e.Line(v,b);break;default:h=new e.Mesh(v,b)}if(h.castShadow=!0,h.userData=A,h.name=y,c.skin&&(f=a.skins[c.skin]),f){var b,w=function(e){for(var r=Object.keys(i),t=0,a=r.length;t<a;t++){var n=i[r[t]];if(n.jointName===e)return n}return null},L=v;(b=m).skinning=!0,(h=new e.SkinnedMesh(L,b,!1)).castShadow=!0,h.userData=A,h.name=y;for(var O=[],T=[],M=0,g=f.jointNames.length;M<g;M++){var S=f.jointNames[M],R=w(S);if(R){O.push(R);var E=f.inverseBindMatrices.array,_=(new e.Matrix4).fromArray(E,16*M);T.push(_)}else console.warn("WARNING: joint: '"+S+"' could not be found")}h.bind(new e.Skeleton(O,T,!1),f.bindShapeMatrix);!function e(t,a,n){var s=t[n];if(void 0!==s)for(var o=0,c=s.length;o<c;o++){var u=s[o],d=i[u],p=r.nodes[u];void 0!==d&&!0===d.isBone&&void 0!==p&&(a.add(d),e(p,d,"children"))}}(c,h,"skeletons")}s.add(h)}else console.warn("GLTFLoader: Couldn't find node \""+d+'".')}if(void 0!==c.camera){var F=a.cameras[c.camera];s.add(F)}if(c.extensions&&c.extensions[n.KHR_MATERIALS_COMMON]&&c.extensions[n.KHR_MATERIALS_COMMON].light){var x=t[n.KHR_MATERIALS_COMMON].lights[c.extensions[n.KHR_MATERIALS_COMMON].light];s.add(x)}return s})})})},E.prototype.loadScenes=function(){var r=this.json;function t(e,a,n){var i=n[e];a.add(i);var s=r.nodes[e];if(s.children)for(var o=s.children,c=0,u=o.length;c<u;c++){t(o[c],i,n)}}return this._withDependencies(["nodes"]).then(function(n){return M(r.scenes,function(r){var i=new e.Scene;void 0!==r.name&&(i.name=r.name),r.extras&&(i.userData=r.extras);for(var s=r.nodes||[],o=0,c=s.length;o<c;o++){t(s[o],i,n.nodes)}return i.traverse(function(e){e.material&&e.material.isRawShaderMaterial&&(e.gltfShader=new a(e,n.nodes),e.onBeforeRender=function(e,r,t){this.gltfShader.update(r,t)})}),i})})},r}();var a=e.GLTFLoader;exports.GLTFLoader=a;
},{"three-v86":"F3le"}]},{},[], null)